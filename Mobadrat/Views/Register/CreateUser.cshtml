@model Mobadrat.Models.User

@{
	ViewData["Title"] = "CreateStudent";
	Layout = "~/Views/Shared/_LoginLayout.cshtml";
}
<link href="~/css/login.css" rel="stylesheet" />
<link href="~/css/createuser.css" rel="stylesheet" />
@*<h4>Add Student Deatils- Controller</h4>
<hr />
<div class="row">
	<div class="col-md-4">
		<form id="studenteForm" novalidate class="needs-validation">
			<div asp-validation-summary="ModelOnly" class="text-danger"></div>
			<div class="form-group">
				<label asp-for="IdentityNumber" class="control-label"></label>
				<input asp-for="IdentityNumber" type="text" class="form-control" id="IdentityNumber" required />
				<span asp-validation-for="IdentityNumber" class="text-danger"></span>
			</div>
			<div class="form-group">
				<label asp-for="UserName" class="control-label"></label>
				<input asp-for="UserName" type="email" class="form-control" id="UserName" />
				<span asp-validation-for="UserName" class="text-danger"></span>
			</div>
			<div class="form-group">
				<label asp-for="UserPassword" class="control-label"></label>
				<input asp-for="UserPassword" type="UserPassword" class="form-control" id="UserPassword" />
				<span asp-validation-for="UserPassword" class="text-danger"></span>
			</div>
			<div class="form-group">
				<button type="button" class="btn btn-primary" onclick="submitStudent()">Submit</button>
			</div>
		</form>
	</div>
</div>*@
<header>
	<div class="container-fluid uper-bar">
		<div class="row">
			<div class="nav-bar date-div col-12">
				<span id="today" class="datespan"></span>
			</div>
		</div>
	</div>
</header>
<div class="user-div">
	<form id="studenteForm" novalidate class="needs-validation" autocomplete="off">
		<div class="container">
			<div class="row login-box">
				<div class="col-lg-12 login-title">
					<label class="sys-lbl">تسجيل حساب جديد</label>
				</div>

				<input type="hidden" asp-for="CreateDateHijry" value="@TempData["CurrentHijryDate"]" />
				<input type="hidden" asp-for="BranchName" value="@ViewBag.PARENT_ORG" id="BranchName" />
				<input type="hidden" asp-for="BranchID" value="@ViewBag.PARENT_ORG_ID" id="BranchID" />
				<input type="hidden" asp-for="DepartmentName" value="@ViewBag.ORG_NAME" id="DepartmentName" />
				<input type="hidden" asp-for="DepartmentID" value="@ViewBag.ORGANIZATION_ID" id="DepartmentID" />
				<input type="hidden" asp-for="EMPLOYEE_ID" value="@ViewBag.EMPLOYEE_ID" id="EMPLOYEE_ID" />
				<input type="hidden" asp-for="SexName" value="@ViewBag.SEX" id="SexName" />

				<div class="form-group col-6">
					<label class="form-control-label data-label-show">رقم الهوية : </label>
					<label class="form-control-label data-label-show" name="NATIONAL_IDENTIFIER">@ViewBag.NATIONAL_IDENTIFIER</label>
					<input type="hidden" asp-for="IdentityNumber" value="@ViewBag.NATIONAL_IDENTIFIER" id="NATIONAL_IDENTIFIER" />
				</div>
				<div class="form-group col-6">
					<label class="form-control-label data-label-show">اسم الموظف : </label>
					<label class="form-control-label data-label-show">@ViewBag.Emp_Full_Name</label>
					<input type="hidden" asp-for="EmployeeFullName" value="@ViewBag.Emp_Full_Name" id="Emp_Full_Name" />
				</div>

				<div class="form-group col-6">
					<label class="form-control-label data-label-show">البريد : </label>
					@*<label class="form-control-label">@ViewBag.EMAIL_ADDRESS</label>*@
					<label class="form-control-label data-label-show">@ViewBag.EMAIL_ADDRESS</label>
					<input type="hidden" asp-for="Email" value="@ViewBag.EMAIL_ADDRESS" id="Email" />
				</div>
				<div class="form-group col-6">
					<label class="form-control-label data-label-show">رقم الجوال : </label>
					<label class="form-control-label data-label-show">@ViewBag.MOBILE</label>
					<input type="hidden" asp-for="MobileNumber" value="@ViewBag.MOBILE" id="MobileNumber" />
				</div>

				<div class="form-group col-6" style="text-align: right">
					<label class="form-control-label">اسم المستخدم</label>
					<input class="input-username" type="text" asp-for="UserName" autocomplete="off" />
					<label class="UserNameValidation" style="display:none"></label>
				</div>
				<div class="form-group col-6" style="text-align: right">
					<label class="form-control-label">كلمة المرور</label>
					<input class="input-password" type="password" asp-for="UserPassword" autocomplete="off" />
					<label class="PasswordValidation" style="display:none"></label>
				</div>

				<div class="col-lg-12 loginbttm">
					<div class="col-lg-12 login-btm login-text">
						<!-- Error Message -->
					</div>
					<div class="col-lg-12 login-btm login-button">
						@*<button id="SubmitButton" onclick="submitStudent()" class="btn btn-outline-primary">حفظ</button>*@
						<a id="SubmitButton" onclick="submitStudent()" value="حفظ" class="btn btn-outline-primary">تحقق</a>
					</div>
				</div>
			</div>
		</div>
	</form>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert-dev.js"></script>

<script type="text/javascript">
	function submitStudent() {
		if ($("#UserName").val() == "") {
			$(".UserNameValidation").css("color", "red");
			$(".UserNameValidation").text("** حقل إلزامي");
			$(".UserNameValidation").slideDown();
			return false
		}
		else {
			$(".UserNameValidation").text("");
		}

		if ($("#UserPassword").val() == "") {
			$(".PasswordValidation").css("color", "red");
			$(".PasswordValidation").text("** حقل إلزامي");
			$(".PasswordValidation").slideDown();
			return false
		}
		else {
			$(".PasswordValidation").text("");
		}
		var data = $("#studenteForm").serialize();
		console.log(data);

		$.ajax({
			type: 'POST',
			url: '/Register/CreateUser',
			contentType: 'application/x-www-form-urlencoded; charset=UTF-8', // when we use .serialize() this generates the data in query string format. this needs the default contentType (default content type is: contentType: 'application/x-www-form-urlencoded; charset=UTF-8') so it is optional, you can remove it
			data: data,
			success: function (result) {
				if (result.isExistInDB == true) {
					swal({
						title: 'المستخدم موجود مسبقا!',
						text: 'سيتم تحويلك لشاشة الدخول',
						type: 'warning',
						timer: 4000,
						confirmButtonText: 'شكرًا لك'
					});
				}
				else {
					swal({
						title: 'تمّ إضافة المستخدم بنجاح!',
						text: 'سيتم تحويلك لشاشة الدخول',
						type: 'success',
						timer: 3000,
						confirmButtonText: 'شكرا لك'
					});
					setTimeout(function () {
						window.location.href = '/Home/Index';
					}, 5000);
					console.log(result);
				}

			},
			error: function () {
				swal("Wrong", "You clicked the button!", "error")
				console.log('Failed ');
			}
		})
	}

</script>

